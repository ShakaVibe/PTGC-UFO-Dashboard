<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PTGC UFO Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Rajdhani', sans-serif; background: #0a0a0a; min-height: 100vh; }
    .font-orbitron { font-family: 'Orbitron', monospace; }
    .font-space { font-family: 'Space Grotesk', sans-serif; }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #1a1a1a; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
    @keyframes fire-flicker { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    .animate-fire { animation: fire-flicker 0.5s ease-in-out infinite; }
    .token-card { transition: all 0.3s ease; }
    .token-card:hover { transform: scale(1.02); }
    .token-card-gold:hover { box-shadow: 0 0 50px rgba(217, 202, 93, 0.5); border-color: rgba(217, 202, 93, 1) !important; }
    .token-card-green:hover { box-shadow: 0 0 50px rgba(124, 252, 0, 0.5); border-color: rgba(124, 252, 0, 1) !important; }
    .modal-overlay { backdrop-filter: blur(8px); }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;
    
    const TOKENS = {
      PTGC: {
        name: 'PTGC',
        address: '0x94534EeEe131840b1c0F61847c572228bdfDDE93',
        logo: '06_PTGC_V1_transparent_bg.png',
        color: 'gold',
        colorHex: '#D9CA5D',
        burnAddress: '0x0000000000000000000000000000000000000369',
        decimals: 18,
        mainPair: '0xf5A89A6487D62df5308CDDA89c566C5B5ef94C11',
        pulseScanUrl: 'https://scan.pulsechain.com/token/0x94534EeEe131840b1c0F61847c572228bdfDDE93'
      },
      UFO: {
        name: 'UFO',
        address: '0x456548A9B56eFBbD89Ca0309edd17a9E20b04018',
        logo: '07_Ufo_transparent.png',
        color: 'green',
        colorHex: '#7CFC00',
        burnAddress: '0x0000000000000000000000000000000000000369',
        decimals: 18,
        mainPair: '0xbeA0e55b82Eb975280041F3b49C4D0bD937b72d5',
        pulseScanUrl: 'https://scan.pulsechain.com/token/0x456548A9B56eFBbD89Ca0309edd17a9E20b04018'
      }
    };
    
    const COMBINED_LOGO = '07_Combined_PTGC_UFO_Transparent.png';
    const BURN_ADDRESS = '0x0000000000000000000000000000000000000369';
    const PULSECHAIN_RPC = 'https://rpc.pulsechain.com';
    const MIN_LIQUIDITY = 1000;
    
    // Burn creatures based on PERCENTAGE of supply
    // 10% = Poseidon, 1% = Whale, 0.1% = Shark, 0.01% = Dolphin, 0.001% = Squid, 0.0001% = Turtle, 0.00001% = Shrimp, smaller = Shell
    const BURN_CREATURES_PERCENT = [
      { name: 'Poseidon', emoji: 'üî±', percent: 10 },
      { name: 'Whale', emoji: 'üêã', percent: 1 },
      { name: 'Shark', emoji: 'ü¶à', percent: 0.1 },
      { name: 'Dolphin', emoji: 'üê¨', percent: 0.01 },
      { name: 'Squid', emoji: 'ü¶ë', percent: 0.001 },
      { name: 'Turtle', emoji: 'üê¢', percent: 0.0001 },
      { name: 'Shrimp', emoji: 'ü¶ê', percent: 0.00001 },
      { name: 'Shell', emoji: 'üêö', percent: 0 }
    ];
    
    const SEA_CREATURES = [
      { name: 'Plankton', emoji: 'ü¶†', min: 0, max: 100 },
      { name: 'Shrimp', emoji: 'ü¶ê', min: 100, max: 1000 },
      { name: 'Crab', emoji: 'ü¶Ä', min: 1000, max: 5000 },
      { name: 'Fish', emoji: 'üêü', min: 5000, max: 10000 },
      { name: 'Octopus', emoji: 'üêô', min: 10000, max: 25000 },
      { name: 'Dolphin', emoji: 'üê¨', min: 25000, max: 50000 },
      { name: 'Shark', emoji: 'ü¶à', min: 50000, max: 100000 },
      { name: 'Whale', emoji: 'üêã', min: 100000, max: 500000 },
      { name: 'Kraken', emoji: 'ü¶ë', min: 500000, max: Infinity }
    ];
    
    // Utility Functions
    const fmt = (n) => n == null || isNaN(n) ? '‚Äî' : Math.floor(Number(n)).toLocaleString('en-US');
    const fmtUSD = (n) => n == null || isNaN(n) ? '‚Äî' : '$' + Math.floor(Number(n)).toLocaleString('en-US');
    
    // Price formatting - handles small decimals properly
    const fmtPrice = (p) => {
      if (!p || isNaN(p) || p === 0) return '‚Äî';
      if (p >= 1) return '$' + p.toFixed(2);
      if (p >= 0.01) return '$' + p.toFixed(4);
      if (p >= 0.0001) return '$' + p.toFixed(6);
      
      // For very small prices, use subscript notation
      const str = p.toExponential(4);
      const [mantissa, exp] = str.split('e');
      const exponent = Math.abs(parseInt(exp));
      const significand = parseFloat(mantissa).toFixed(4).replace('.', '');
      return { prefix: '$0.0', zeros: exponent - 1, digits: significand.slice(0, 4) };
    };
    
    const PriceDisplay = ({ price, className = '' }) => {
      const formatted = fmtPrice(price);
      if (typeof formatted === 'string') {
        return <span className={className}>{formatted}</span>;
      }
      return (
        <span className={className}>
          {formatted.prefix}<sub className="text-[0.6em] opacity-70">{formatted.zeros}</sub>{formatted.digits}
        </span>
      );
    };
    
    const getLogoUrl = (address) => address ? `https://dd.dexscreener.com/ds-data/tokens/pulsechain/${address.toLowerCase()}.png` : null;
    
    // Get creature counts based on burn PERCENTAGE
    // Returns array of creatures with counts (e.g., 8.75% = 8 whales + remainder)
    const getBurnCreatures = (burnPercent, minCreature = 'Shell') => {
      const creatures = [];
      let remaining = burnPercent;
      
      // Find minimum creature index
      const minIndex = BURN_CREATURES_PERCENT.findIndex(c => c.name === minCreature);
      
      for (let i = 0; i < BURN_CREATURES_PERCENT.length; i++) {
        const creature = BURN_CREATURES_PERCENT[i];
        const nextCreature = BURN_CREATURES_PERCENT[i + 1];
        
        // Skip if below minimum creature threshold
        if (minIndex >= 0 && i > minIndex) continue;
        
        if (creature.percent > 0 && remaining >= creature.percent) {
          const count = Math.floor(remaining / creature.percent);
          if (count > 0) {
            creatures.push({ ...creature, count });
            remaining -= count * creature.percent;
          }
        }
      }
      
      // Add remaining as smallest creature if above threshold
      if (remaining > 0 && minIndex >= 0) {
        const smallestAllowed = BURN_CREATURES_PERCENT[minIndex];
        if (remaining >= smallestAllowed.percent || smallestAllowed.percent === 0) {
          const existing = creatures.find(c => c.name === smallestAllowed.name);
          if (existing) existing.count += 1;
          else if (remaining >= smallestAllowed.percent) creatures.push({ ...smallestAllowed, count: 1 });
        }
      }
      
      return creatures;
    };
    
    // Get single creature for a burn percentage (for 1hr, 6hr, etc displays)
    const getSingleBurnCreature = (burnPercent) => {
      for (const creature of BURN_CREATURES_PERCENT) {
        if (burnPercent >= creature.percent) return creature;
      }
      return BURN_CREATURES_PERCENT[BURN_CREATURES_PERCENT.length - 1];
    };
    
    // API Functions
    const fetchDexScreenerData = async (tokenAddress, mainPairAddress) => {
      try {
        let mainPairData = null;
        if (mainPairAddress) {
          const pairRes = await fetch(`https://api.dexscreener.com/latest/dex/pairs/pulsechain/${mainPairAddress}`);
          const pairData = await pairRes.json();
          if (pairData.pair) mainPairData = pairData.pair;
        }
        
        const res = await fetch(`https://api.dexscreener.com/latest/dex/tokens/${tokenAddress}`);
        const data = await res.json();
        if (data.pairs && data.pairs.length > 0) {
          const pairs = data.pairs.map(p => ({
            ...p,
            liquidity: p.liquidity?.usd || 0,
            volume24h: p.volume?.h24 || 0
          })).sort((a, b) => b.liquidity - a.liquidity);
          
          const totalVolume = pairs.reduce((sum, p) => sum + p.volume24h, 0);
          const totalLiquidity = pairs.reduce((sum, p) => sum + p.liquidity, 0);
          const totalBuys = pairs.reduce((sum, p) => sum + (p.txns?.h24?.buys || 0), 0);
          const totalSells = pairs.reduce((sum, p) => sum + (p.txns?.h24?.sells || 0), 0);
          const pricePair = mainPairData || pairs[0];
          
          return {
            price: parseFloat(pricePair.priceUsd) || 0,
            priceNative: parseFloat(pricePair.priceNative) || 0,
            priceChange24h: pricePair.priceChange?.h24 || 0,
            mcap: pricePair.marketCap || pricePair.fdv || 0,
            liquidity: totalLiquidity,
            volume24h: totalVolume,
            buys24h: totalBuys,
            sells24h: totalSells,
            pairs
          };
        }
        return null;
      } catch (err) { console.error('DexScreener error:', err); return null; }
    };
    
    const fetchHolderCount = async (tokenAddress) => {
      try {
        const res = await fetch(`https://api.scan.pulsechain.com/api/v2/tokens/${tokenAddress}/counters`);
        const data = await res.json();
        return parseInt(data.token_holders_count) || 0;
      } catch { return 0; }
    };
    
    const fetchBurnData = async (tokenAddress, decimals) => {
      try {
        const balanceRes = await fetch(PULSECHAIN_RPC, {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ jsonrpc: '2.0', method: 'eth_call', params: [{ to: tokenAddress, data: '0x70a08231000000000000000000000000' + BURN_ADDRESS.slice(2) }, 'latest'], id: 1 })
        });
        const balanceData = await balanceRes.json();
        const burned = Number(BigInt(balanceData.result || '0x0')) / Math.pow(10, decimals);
        
        const supplyRes = await fetch(PULSECHAIN_RPC, {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ jsonrpc: '2.0', method: 'eth_call', params: [{ to: tokenAddress, data: '0x18160ddd' }, 'latest'], id: 2 })
        });
        const supplyData = await supplyRes.json();
        const totalSupply = Number(BigInt(supplyData.result || '0x0')) / Math.pow(10, decimals);
        
        return { total: burned, percent: totalSupply > 0 ? (burned / totalSupply) * 100 : 0, totalSupply };
      } catch { return { total: 0, percent: 0, totalSupply: 0 }; }
    };
    
    const fetchBurnHistory = async (tokenAddress, decimals, hours) => {
      try {
        const blockRes = await fetch(PULSECHAIN_RPC, {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ jsonrpc: '2.0', method: 'eth_blockNumber', params: [], id: 1 })
        });
        const blockData = await blockRes.json();
        const currentBlock = parseInt(blockData.result, 16);
        const blocksPerHour = 360; // ~10 sec blocks
        const fromBlock = '0x' + Math.max(0, currentBlock - (blocksPerHour * hours)).toString(16);
        
        const transferSig = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef';
        const burnPadded = '0x000000000000000000000000' + BURN_ADDRESS.slice(2).toLowerCase();
        
        const logsRes = await fetch(PULSECHAIN_RPC, {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            jsonrpc: '2.0', method: 'eth_getLogs',
            params: [{ address: tokenAddress, topics: [transferSig, null, burnPadded], fromBlock, toBlock: 'latest' }], id: 1
          })
        });
        const logsData = await logsRes.json();
        
        let burnAmount = 0;
        if (logsData.result && Array.isArray(logsData.result)) {
          burnAmount = logsData.result.reduce((sum, log) => sum + Number(BigInt(log.data)) / Math.pow(10, decimals), 0);
        }
        return burnAmount;
      } catch { return 0; }
    };
    
    const fetchPLSPrice = async () => {
      try {
        const res = await fetch('https://api.dexscreener.com/latest/dex/pairs/pulsechain/0xe56043671df55de5cdf8459710433c10324de0ae');
        return parseFloat((await res.json()).pair?.priceUsd) || 0.00005;
      } catch { return 0.00005; }
    };
    
    // Components
    
    // Burn Details Modal
    const BurnModal = ({ isOpen, onClose, token, burnData, price, config, totalSupply }) => {
      const [burnHistory, setBurnHistory] = useState({ h1: 0, h6: 0, h12: 0, h24: 0 });
      const [loading, setLoading] = useState(true);
      
      useEffect(() => {
        if (!isOpen) return;
        const fetchHistory = async () => {
          setLoading(true);
          const [h1, h6, h12, h24] = await Promise.all([
            fetchBurnHistory(config.address, config.decimals, 1),
            fetchBurnHistory(config.address, config.decimals, 6),
            fetchBurnHistory(config.address, config.decimals, 12),
            fetchBurnHistory(config.address, config.decimals, 24)
          ]);
          setBurnHistory({ h1, h6, h12, h24 });
          setLoading(false);
        };
        fetchHistory();
      }, [isOpen, config]);
      
      if (!isOpen) return null;
      
      const theme = config.color === 'gold' ? { text: 'text-[#D9CA5D]', border: 'border-[#D9CA5D]' } : { text: 'text-[#7CFC00]', border: 'border-[#7CFC00]' };
      const burnCreatures = getBurnCreatures(burnData?.percent || 0, 'Squid');
      
      // Calculate percentage for each time period
      const getPercentForAmount = (amount) => totalSupply > 0 ? (amount / totalSupply) * 100 : 0;
      
      const timeBoxes = [
        { label: '1 Hour', value: burnHistory.h1, percent: getPercentForAmount(burnHistory.h1) },
        { label: '6 Hours', value: burnHistory.h6, percent: getPercentForAmount(burnHistory.h6) },
        { label: '12 Hours', value: burnHistory.h12, percent: getPercentForAmount(burnHistory.h12) },
        { label: '24 Hours', value: burnHistory.h24, percent: getPercentForAmount(burnHistory.h24) }
      ];
      
      return (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay bg-black/70" onClick={onClose}>
          <div className="bg-[#111] border border-orange-500/30 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-auto" onClick={e => e.stopPropagation()}>
            <div className="p-5">
              {/* Header */}
              <div className="flex items-center justify-between mb-4">
                <div className="flex items-center gap-3">
                  <span className="text-2xl">üî•</span>
                  <h2 className="text-xl font-bold text-orange-400 font-orbitron">{token} Burn Stats</h2>
                </div>
                <button onClick={onClose} className="text-white/60 hover:text-white text-2xl">√ó</button>
              </div>
              
              {/* Main Stats Row */}
              <div className="bg-gradient-to-r from-orange-500/15 via-orange-600/10 to-orange-500/15 border border-orange-500/30 rounded-xl p-4 mb-4">
                <div className="grid grid-cols-3 gap-4 text-center mb-3">
                  <div>
                    <div className="text-orange-400/70 text-xs uppercase mb-1">Total Burned</div>
                    <div className="text-xl font-bold text-orange-400">{fmt(burnData?.total)}</div>
                  </div>
                  <div>
                    <div className="text-orange-400/70 text-xs uppercase mb-1">USD Value</div>
                    <div className="text-xl font-bold text-green-400">{fmtUSD((burnData?.total || 0) * price)}</div>
                  </div>
                  <div>
                    <div className="text-orange-400/70 text-xs uppercase mb-1">% of Supply</div>
                    <div className="text-xl font-bold text-white">{(burnData?.percent || 0).toFixed(2)}%</div>
                  </div>
                </div>
                
                {/* Progress Bar */}
                <div className="h-3 bg-black/50 rounded-full overflow-hidden mb-3">
                  <div className="h-full bg-gradient-to-r from-orange-500 to-orange-400 rounded-full transition-all" style={{ width: `${Math.min(burnData?.percent || 0, 100)}%` }}></div>
                </div>
                
                {/* Sea Creatures */}
                <div className="flex items-center justify-center gap-2 flex-wrap">
                  <span className="text-3xl animate-fire">üî•</span>
                  {burnCreatures.map((c, i) => (
                    <span key={i} className="flex items-center gap-1">
                      <span className="text-3xl">{c.emoji}</span>
                      <span className="text-white/80 text-lg font-bold">x{c.count}</span>
                    </span>
                  ))}
                </div>
              </div>
              
              {/* Time-based Burns - Larger fonts */}
              <div className="grid grid-cols-2 gap-3 mb-4">
                {timeBoxes.map(({ label, value, percent }) => {
                  const creature = getSingleBurnCreature(percent);
                  return (
                    <div key={label} className="bg-[#1a1a1a] border border-orange-500/20 rounded-xl p-4">
                      <div className="flex items-center justify-between mb-2">
                        <span className="text-white/60 text-sm uppercase">{label}</span>
                        <span className="text-4xl">{creature.emoji}</span>
                      </div>
                      <div className="text-2xl font-bold text-orange-400 font-space">{loading ? '...' : fmt(value)}</div>
                      <div className="text-lg text-green-400 font-semibold">{loading ? '' : fmtUSD(value * price)}</div>
                      <div className="text-white/40 text-sm">{loading ? '' : percent.toFixed(6)}%</div>
                    </div>
                  );
                })}
              </div>
              
              {/* Burn Address */}
              <div className="text-center text-white/40 text-xs">
                Burn Address: <span className="font-mono">{BURN_ADDRESS}</span>
              </div>
            </div>
          </div>
        </div>
      );
    };
    
    // LP Pair Row
    const LPPairRow = ({ pair, theme, mainTokenAddress }) => {
      const [logoError, setLogoError] = useState(false);
      const [showDetails, setShowDetails] = useState(false);
      
      const liq = pair.liquidity || 0;
      const vol = pair.volume24h || 0;
      const ratio = vol > 0 ? liq / vol : 0;
      const buys = pair.txns?.h24?.buys || 0;
      const sells = pair.txns?.h24?.sells || 0;
      const priceChange = pair.priceChange?.h24 || 0;
      const isUp = priceChange >= 0;
      
      const isBaseMain = pair.baseToken?.address?.toLowerCase() === mainTokenAddress?.toLowerCase();
      const otherToken = isBaseMain ? pair.quoteToken : pair.baseToken;
      const logoUrl = getLogoUrl(otherToken?.address);
      const fallbackLetter = otherToken?.symbol?.[0] || '?';
      
      return (
        <div className={`${theme.card} border ${theme.border} rounded-lg p-3 sm:p-4 transition-all hover:border-opacity-60`}>
          <div className="sm:hidden">
            <div className="flex items-center gap-3 mb-2">
              {!logoError && logoUrl ? <img src={logoUrl} alt="" className="w-8 h-8 rounded-full bg-black/50" onError={() => setLogoError(true)}/> : <div className="w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-400">{fallbackLetter}</div>}
              <div className="flex-1">
                <div className={`font-semibold ${theme.text} text-sm`}>{pair.baseToken?.symbol}/{pair.quoteToken?.symbol}</div>
                <div className="text-gray-500 text-xs">PulseX V2</div>
              </div>
              <div className={`text-sm font-semibold ${isUp ? 'text-green-400' : 'text-red-400'}`}>{isUp ? '‚ñ≤' : '‚ñº'} {Math.abs(priceChange).toFixed(1)}%</div>
            </div>
            <div className="grid grid-cols-4 gap-2 text-center text-xs">
              <div><div className="text-gray-400">Vol</div><div className="text-white font-space">{fmtUSD(vol)}</div></div>
              <div><div className="text-gray-400">Liq</div><div className="text-white font-space">{fmtUSD(liq)}</div></div>
              <div><div className="text-gray-400">Txns</div><div><span className="text-green-400">{buys}</span>/<span className="text-red-400">{sells}</span></div></div>
              <div><div className="text-gray-400">Ratio</div><div className="font-bold text-white">{ratio.toFixed(3)}x</div></div>
            </div>
          </div>
          
          <div className="hidden sm:grid grid-cols-12 gap-2 items-center">
            <div className="col-span-1 flex justify-center">
              {!logoError && logoUrl ? <img src={logoUrl} alt="" className="w-10 h-10 rounded-full bg-black/50" onError={() => setLogoError(true)}/> : <div className="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-sm font-bold text-gray-400">{fallbackLetter}</div>}
            </div>
            <div className="col-span-2">
              <div className={`font-semibold ${theme.text} text-base`}>{pair.baseToken?.symbol}/{pair.quoteToken?.symbol}</div>
              <div className="text-gray-500 text-sm">PulseX V2</div>
            </div>
            <div className="col-span-2 text-right">
              <div className="text-white text-xs">Volume</div>
              <div className="text-white font-space font-semibold">{fmtUSD(vol)}</div>
            </div>
            <div className="col-span-2 text-right">
              <div className="text-white text-xs">Liquidity</div>
              <div className="text-white font-space">{fmtUSD(liq)}</div>
            </div>
            <div className="col-span-1 text-center">
              <div className="text-white text-xs">24h</div>
              <div className={`font-semibold ${isUp ? 'text-green-400' : 'text-red-400'}`}>{isUp ? '‚ñ≤' : '‚ñº'} {Math.abs(priceChange).toFixed(1)}%</div>
            </div>
            <div className="col-span-1 text-center">
              <div className="text-white text-xs">Txns</div>
              <div><span className="text-green-400">{buys}</span>/<span className="text-red-400">{sells}</span></div>
            </div>
            <div className="col-span-1 text-right">
              <div className="text-white text-xs">Ratio</div>
              <div className="font-bold text-white">{ratio.toFixed(3)}x</div>
            </div>
            <div className="col-span-2 flex items-center justify-end gap-2">
              <button onClick={() => setShowDetails(!showDetails)} className="text-lg hover:scale-110 transition-transform" title="Pool info">‚ÑπÔ∏è</button>
              <a href={`https://dexscreener.com/pulsechain/${pair.pairAddress}`} target="_blank" className="text-lg hover:scale-110 transition-transform" title="DexScreener">üìà</a>
              <a href={`https://www.dextools.io/app/en/pulse/pair-explorer/${pair.pairAddress}`} target="_blank" className="text-lg hover:scale-110 transition-transform" title="DexTools">üìä</a>
            </div>
          </div>
          
          {showDetails && (
            <div className="mt-3 pt-3 border-t border-white/10 text-sm grid grid-cols-2 sm:grid-cols-4 gap-2">
              <div><span className="text-gray-400">Pair:</span> <span className="text-white font-mono text-xs">{pair.pairAddress?.slice(0, 10)}...</span></div>
              <div><span className="text-gray-400">Created:</span> <span className="text-white">{pair.pairCreatedAt ? new Date(pair.pairCreatedAt).toLocaleDateString() : '‚Äî'}</span></div>
              <div><span className="text-gray-400">Price:</span> <PriceDisplay price={parseFloat(pair.priceUsd)} className="text-white"/></div>
              <div><span className="text-gray-400">FDV:</span> <span className="text-white">{fmtUSD(pair.fdv)}</span></div>
            </div>
          )}
        </div>
      );
    };
    
    // HOME PAGE
    const HomePage = ({ onSelectToken }) => {
      const [tokenData, setTokenData] = useState({ PTGC: null, UFO: null });
      const [loading, setLoading] = useState(true);
      
      useEffect(() => {
        const fetchData = async () => {
          const [ptgcData, ufoData] = await Promise.all([
            fetchDexScreenerData(TOKENS.PTGC.address, TOKENS.PTGC.mainPair),
            fetchDexScreenerData(TOKENS.UFO.address, TOKENS.UFO.mainPair)
          ]);
          setTokenData({ PTGC: ptgcData, UFO: ufoData });
          setLoading(false);
        };
        fetchData();
        const interval = setInterval(fetchData, 30000);
        return () => clearInterval(interval);
      }, []);
      
      const MiniSparkline = ({ isPositive, color }) => {
        const points = isPositive ? "0,20 15,17 30,14 45,16 60,11 75,13 90,8 100,5" : "0,5 15,8 30,6 45,10 60,12 75,9 90,15 100,18";
        return <svg viewBox="0 0 100 24" className="w-16 sm:w-20 lg:w-24 h-6 sm:h-8"><polyline points={points} fill="none" stroke={color} strokeWidth="2" strokeLinecap="round"/></svg>;
      };
      
      const TokenCard = ({ token, data }) => {
        const config = TOKENS[token];
        const isGold = config.color === 'gold';
        const borderColor = isGold ? 'border-[#D9CA5D]/50' : 'border-[#7CFC00]/50';
        const textColor = isGold ? 'text-[#D9CA5D]' : 'text-[#7CFC00]';
        const bgGradient = isGold ? 'bg-gradient-to-r from-[#D9CA5D]/20 via-[#1a1a1a] to-[#1a1a1a]' : 'bg-gradient-to-r from-[#7CFC00]/20 via-[#1a1a1a] to-[#1a1a1a]';
        const cardClass = isGold ? 'token-card-gold' : 'token-card-green';
        const isPositive = (data?.priceChange24h || 0) >= 0;
        
        return (
          <div onClick={() => onSelectToken(token)} className={`token-card ${cardClass} cursor-pointer rounded-2xl border-2 ${borderColor} ${bgGradient} p-4 sm:p-6 lg:p-8`}>
            <div className="flex flex-col sm:flex-row items-center gap-4 sm:gap-6 lg:gap-8">
              <img src={config.logo} alt={token} className="w-20 h-20 sm:w-24 sm:h-24 lg:w-32 lg:h-32 object-contain"/>
              <div className="text-center sm:text-left">
                <div className={`font-orbitron text-2xl sm:text-3xl lg:text-4xl font-bold ${textColor}`}>{token}</div>
                <div className="text-white/40 text-xs sm:text-sm font-mono mt-1">{config.address.slice(0, 6)}...{config.address.slice(-4)}</div>
              </div>
              <div className="flex-1 text-center sm:text-right">
                <PriceDisplay price={data?.price} className="text-white font-bold text-xl sm:text-2xl lg:text-3xl"/>
                <div className="text-white/50 text-sm sm:text-base lg:text-xl mt-1">MCap: {fmtUSD(data?.mcap)}</div>
              </div>
              <div className="flex items-center gap-2 sm:gap-4">
                <MiniSparkline isPositive={isPositive} color={isPositive ? '#22c55e' : '#ef4444'}/>
                <div className={`px-2 sm:px-3 py-1 rounded-lg text-sm sm:text-base lg:text-xl font-bold ${isPositive ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'}`}>
                  {isPositive ? '‚ñ≤' : '‚ñº'} {Math.abs(data?.priceChange24h || 0).toFixed(2)}%
                </div>
              </div>
            </div>
          </div>
        );
      };
      
      return (
        <div className="min-h-screen flex flex-col px-4">
          <header className="text-center pt-4 sm:pt-6">
            <img src={COMBINED_LOGO} alt="PTGC & UFO" className="h-48 sm:h-64 md:h-80 lg:h-96 w-auto object-contain mx-auto"/>
            <h1 className="font-orbitron text-3xl sm:text-4xl lg:text-5xl font-bold tracking-wider mb-2 -mt-6 sm:-mt-8 lg:-mt-12" style={{ background: 'linear-gradient(180deg, #FFF 0%, #C0C0C0 40%, #808080 70%, #404040 100%)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' }}>DASHBOARD</h1>
            <p className="text-white/50 text-sm sm:text-base lg:text-lg mb-6 sm:mb-8 lg:mb-10">A community tool built for The Grays Ecosystem</p>
          </header>
          <div className="flex-1 flex items-start justify-center pb-8">
            <div className="flex flex-col gap-4 sm:gap-6 max-w-4xl w-full">
              {loading ? <><div className="animate-pulse bg-white/10 rounded-2xl h-32 sm:h-40"></div><div className="animate-pulse bg-white/10 rounded-2xl h-32 sm:h-40"></div></> : <><TokenCard token="PTGC" data={tokenData.PTGC}/><TokenCard token="UFO" data={tokenData.UFO}/></>}
            </div>
          </div>
          <footer className="text-center py-4 sm:py-6 border-t border-white/10">
            <p className="text-white/30 text-xs px-4">Not financial advice. Data may be delayed. DYOR.</p>
          </footer>
        </div>
      );
    };
    
    // DASHBOARD
    const Dashboard = ({ token, onBack }) => {
      const config = TOKENS[token];
      const isGold = config.color === 'gold';
      const theme = {
        text: isGold ? 'text-[#D9CA5D]' : 'text-[#7CFC00]',
        border: isGold ? 'border-[#D9CA5D]/30' : 'border-[#7CFC00]/30',
        bg: isGold ? 'bg-[#D9CA5D]' : 'bg-[#7CFC00]',
        card: 'bg-[#111]/80'
      };
      
      const [data, setData] = useState(null);
      const [burnData, setBurnData] = useState({ total: 0, percent: 0, totalSupply: 0 });
      const [holders, setHolders] = useState(0);
      const [plsPrice, setPlsPrice] = useState(0.00005);
      const [loading, setLoading] = useState(true);
      const [lpSortBy, setLpSortBy] = useState('volume');
      const [lpSortDir, setLpSortDir] = useState('desc');
      const [lastUpdate, setLastUpdate] = useState(new Date());
      const [showBurnModal, setShowBurnModal] = useState(false);
      
      useEffect(() => {
        const fetchAllData = async () => {
          const [dexData, holdersCount, burn, pls] = await Promise.all([
            fetchDexScreenerData(config.address, config.mainPair),
            fetchHolderCount(config.address),
            fetchBurnData(config.address, config.decimals),
            fetchPLSPrice()
          ]);
          setData(dexData);
          setHolders(holdersCount);
          setBurnData(burn);
          setPlsPrice(pls);
          setLastUpdate(new Date());
          setLoading(false);
        };
        fetchAllData();
        const interval = setInterval(fetchAllData, 60000);
        return () => clearInterval(interval);
      }, [token]);
      
      const sortedPairs = useMemo(() => {
        if (!data?.pairs) return [];
        return [...data.pairs].sort((a, b) => {
          let aVal, bVal;
          switch (lpSortBy) {
            case 'ratio': aVal = a.volume24h > 0 ? a.liquidity / a.volume24h : 0; bVal = b.volume24h > 0 ? b.liquidity / b.volume24h : 0; break;
            case 'volume': aVal = a.volume24h; bVal = b.volume24h; break;
            case 'liquidity': aVal = a.liquidity; bVal = b.liquidity; break;
            case 'change': aVal = a.priceChange?.h24 || 0; bVal = b.priceChange?.h24 || 0; break;
            default: aVal = a.volume24h; bVal = b.volume24h;
          }
          return lpSortDir === 'desc' ? bVal - aVal : aVal - bVal;
        });
      }, [data?.pairs, lpSortBy, lpSortDir]);
      
      const highPairs = sortedPairs.filter(p => p.liquidity >= MIN_LIQUIDITY);
      const lowPairs = sortedPairs.filter(p => p.liquidity < MIN_LIQUIDITY);
      const [showLow, setShowLow] = useState(false);
      
      // Get burn creatures based on percentage (minimum Squid for main display)
      const burnCreatures = getBurnCreatures(burnData?.percent || 0, 'Squid');
      const plsRatio = data?.price && plsPrice ? (data.price / plsPrice).toFixed(4) : '‚Äî';
      
      if (loading) {
        return (
          <div className="min-h-screen flex items-center justify-center">
            <div className="text-center">
              <div className={`w-16 h-16 mx-auto mb-4 rounded-full border-4 ${theme.border} border-t-transparent animate-spin`}></div>
              <div className={`font-orbitron text-lg ${theme.text}`}>Loading {token}...</div>
            </div>
          </div>
        );
      }
      
      return (
        <div className="min-h-screen">
          {/* Header */}
          <header className="sticky top-0 z-50 bg-[#0a0a0a]/95 backdrop-blur border-b border-white/10">
            <div className="max-w-7xl mx-auto px-3 sm:px-6 py-2 sm:py-3">
              <div className="flex items-center justify-between gap-2 flex-wrap">
                <div className="flex items-center gap-2 sm:gap-4">
                  <button onClick={onBack} className="text-white/60 hover:text-white text-sm">‚Üê Home</button>
                  <img src={config.logo} alt={token} className="w-10 h-10 sm:w-12 sm:h-12 object-contain"/>
                  <div>
                    <span className={`font-orbitron text-xl sm:text-2xl font-bold ${theme.text}`}>{token}</span>
                    <div className="text-white/40 text-xs font-mono hidden sm:block">{config.address.slice(0, 6)}...{config.address.slice(-4)}</div>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-white/40 text-xs hidden md:block">Updated {lastUpdate.toLocaleTimeString()}</span>
                  <a href={config.pulseScanUrl} target="_blank" className={`px-2 sm:px-3 py-1.5 rounded border ${theme.border} ${theme.text} text-xs sm:text-sm font-medium hover:bg-white/5`}>Explorer</a>
                  <button className={`px-2 sm:px-3 py-1.5 rounded ${theme.bg} text-black text-xs sm:text-sm font-bold`}>KPI Report</button>
                </div>
              </div>
            </div>
          </header>
          
          {/* Stats Row */}
          <div className="border-b border-white/10">
            <div className="max-w-7xl mx-auto px-3 sm:px-6 py-3 sm:py-4">
              <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3">
                {[
                  { label: 'PRICE USD', value: <PriceDisplay price={data?.price} className={theme.text}/>, sub: <span className={data?.priceChange24h >= 0 ? 'text-green-400' : 'text-red-400'}>{data?.priceChange24h >= 0 ? '‚ñ≤' : '‚ñº'} {Math.abs(data?.priceChange24h || 0).toFixed(2)}%</span> },
                  { label: 'PLS RATIO', value: `${plsRatio}x`, sub: '‚Äî', valueClass: theme.text },
                  { label: 'MARKET CAP', value: fmtUSD(data?.mcap), sub: '‚Äî', valueClass: theme.text },
                  { label: 'VOLUME 24H', value: fmtUSD(data?.volume24h), sub: '‚Äî', valueClass: theme.text },
                  { label: 'LIQUIDITY', value: fmtUSD(data?.liquidity), sub: '‚Äî', valueClass: theme.text },
                  { label: 'TXNS 24H', value: <><span className="text-green-400">{data?.buys24h || 0}</span> / <span className="text-red-400">{data?.sells24h || 0}</span></>, sub: 'buys / sells' }
                ].map((stat, i) => (
                  <div key={i} className={`${theme.card} border ${theme.border} rounded-lg p-3 sm:p-4`}>
                    <div className="text-white text-xs uppercase mb-1">{stat.label}</div>
                    <div className={`text-xl sm:text-2xl font-bold ${stat.valueClass || ''}`}>{stat.value}</div>
                    <div className="text-sm text-white/50">{stat.sub}</div>
                  </div>
                ))}
              </div>
            </div>
          </div>
          
          {/* Burn Section - ProWeb Orange Style */}
          <div className="max-w-7xl mx-auto px-3 sm:px-6 py-4 sm:py-6">
            <div className="grid grid-cols-1 lg:grid-cols-4 gap-3 sm:gap-4">
              {/* MAIN BURN BOX - Orange Themed */}
              <div className="lg:col-span-2 bg-gradient-to-r from-orange-500/15 via-orange-600/10 to-orange-500/15 border border-orange-500/30 rounded-xl p-4 cursor-pointer hover:border-orange-500/50 transition-all" onClick={() => setShowBurnModal(true)}>
                <div className="flex items-center justify-between mb-3">
                  <div className="flex items-center gap-2 text-xs text-orange-400/90 uppercase font-semibold">üî• Total Supply Burned</div>
                  <span className="text-orange-400/60 text-xs">Click for details ‚Üí</span>
                </div>
                <div className="flex items-center gap-3 mb-3 flex-wrap">
                  <span className={`text-2xl font-bold ${theme.text}`}>{fmt(burnData?.total)}</span>
                  <span className="text-lg font-bold text-green-400">{fmtUSD((burnData?.total || 0) * (data?.price || 0))}</span>
                  <span className="text-white/50">{(burnData?.percent || 0).toFixed(2)}%</span>
                </div>
                <div className="h-2 bg-black/50 rounded-full overflow-hidden mb-3">
                  <div className="h-full bg-gradient-to-r from-orange-500 to-orange-400 rounded-full" style={{ width: `${Math.min(burnData?.percent || 0, 100)}%` }}></div>
                </div>
                <div className="flex items-center gap-2 flex-wrap">
                  <span className="text-2xl animate-fire">üî•</span>
                  {burnCreatures.map((c, i) => (
                    <span key={i} className="flex items-center gap-1">
                      <span className="text-2xl">{c.emoji}</span>
                      <span className="text-white/70 text-sm font-bold">x{c.count}</span>
                    </span>
                  ))}
                </div>
              </div>
              </div>
              
              {/* Other Stats */}
              <div className={`${theme.card} border ${theme.border} rounded-xl p-4`}>
                <div className="flex items-center gap-2 mb-2"><span className="text-xl">üìä</span><span className="text-white text-sm font-medium">TOTAL SUPPLY</span></div>
                <div className={`text-xl sm:text-2xl font-bold ${theme.text}`}>{fmt(burnData?.totalSupply)}</div>
              </div>
              <div className={`${theme.card} border ${theme.border} rounded-xl p-4`}>
                <div className="flex items-center gap-2 mb-2"><span className="text-xl">üë•</span><span className="text-white text-sm font-medium">HOLDERS</span></div>
                <div className={`text-xl sm:text-2xl font-bold ${theme.text}`}>{fmt(holders)}</div>
              </div>
            </div>
          </div>
          
          {/* LP Pairs */}
          <div className="max-w-7xl mx-auto px-3 sm:px-6 py-4 sm:py-6">
            <div className="flex items-center justify-between mb-3 flex-wrap gap-2">
              <h2 className="text-lg font-semibold text-white">LP Pairs <span className="text-gray-500 font-normal text-sm">({highPairs.length} with $1K+ LP)</span></h2>
              <div className={`${theme.card} border ${theme.border} rounded-lg px-3 py-2 flex items-center gap-2`}>
                <span className="text-gray-400 text-xs">Sort:</span>
                {['Ratio', 'Volume', 'Liquidity', '24h %'].map((label, i) => {
                  const col = ['ratio', 'volume', 'liquidity', 'change'][i];
                  return (
                    <button key={col} onClick={() => { if (lpSortBy === col) setLpSortDir(lpSortDir === 'desc' ? 'asc' : 'desc'); else { setLpSortBy(col); setLpSortDir('desc'); } }}
                      className={`px-2 py-1 rounded text-xs font-medium ${lpSortBy === col ? `${theme.text} bg-white/10` : 'text-gray-500 hover:text-gray-300'}`}>
                      {label}{lpSortBy === col && <span className="ml-1">{lpSortDir === 'desc' ? '‚Üì' : '‚Üë'}</span>}
                    </button>
                  );
                })}
              </div>
            </div>
            
            <div className="space-y-2">
              {highPairs.map((p, i) => <LPPairRow key={p.pairAddress || i} pair={p} theme={theme} mainTokenAddress={config.address}/>)}
            </div>
            
            {lowPairs.length > 0 && (
              <div className="mt-3">
                <button onClick={() => setShowLow(!showLow)} className={`w-full ${theme.card} border ${theme.border} rounded-lg p-2 flex items-center justify-between text-sm`}>
                  <span className="text-gray-400">{showLow ? 'Hide' : 'Show'} {lowPairs.length} pairs &lt;$1K LP</span>
                  <span className={theme.text}>{showLow ? '‚ñ≤' : '‚ñº'}</span>
                </button>
                {showLow && <div className="mt-2 space-y-2">{lowPairs.map((p, i) => <LPPairRow key={p.pairAddress || i} pair={p} theme={theme} mainTokenAddress={config.address}/>)}</div>}
              </div>
            )}
          </div>
          
          {/* Holder Tiers */}
          <div className="max-w-7xl mx-auto px-3 sm:px-6 py-4 sm:py-6">
            <h2 className={`font-bold text-lg ${theme.text} mb-4`}>ü¶ë Holder Tiers</h2>
            <div className="grid grid-cols-3 sm:grid-cols-5 lg:grid-cols-9 gap-2 sm:gap-3">
              {SEA_CREATURES.map((c) => (
                <div key={c.name} className={`${theme.card} border ${theme.border} rounded-lg p-2 sm:p-3 text-center hover:bg-white/10 transition-all`}>
                  <div className="text-2xl sm:text-3xl mb-1">{c.emoji}</div>
                  <div className="text-white text-xs font-bold">{c.name}</div>
                  <div className={`${theme.text} text-xs`}>{c.max === Infinity ? `$${fmt(c.min)}+` : `$${fmt(c.min)}`}</div>
                </div>
              ))}
            </div>
          </div>
          
          <footer className="text-center py-4 border-t border-white/10 mt-8">
            <p className="text-white/30 text-xs px-4">Not financial advice. Data may be delayed. DYOR.</p>
          </footer>
          
          {/* Burn Modal */}
          <BurnModal isOpen={showBurnModal} onClose={() => setShowBurnModal(false)} token={token} burnData={burnData} price={data?.price || 0} config={config} totalSupply={burnData?.totalSupply || 0}/>
        </div>
      );
    };
    
    // MAIN APP
    const App = () => {
      const [view, setView] = useState('home');
      const [selectedToken, setSelectedToken] = useState(null);
      
      if (view === 'dashboard' && selectedToken) {
        return <Dashboard token={selectedToken} onBack={() => { setView('home'); setSelectedToken(null); }}/>;
      }
      return <HomePage onSelectToken={(token) => { setSelectedToken(token); setView('dashboard'); }}/>;
    };
    
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
